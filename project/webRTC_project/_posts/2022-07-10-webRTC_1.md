---
layout: post
title: webRTC_1
categories: [Project]
tags: [project]
description: >
  webRTC_1
invert_sidebar: false
---
# WebRTC(1) : ê°œë… ì•Œê¸°

### ğŸ”–Â Keyword

P2P / ì‹¤ì‹œê°„ ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì†¡ìˆ˜ì‹ 

ICE

Signaling / TURN / STURN Server

NAT

Mesh / SFU / MCU

---

ğŸ“¢Â ì´ë²ˆì— ì‹¸í”¼ 2í•™ê¸° ê³µí†µ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  webRTCì— ëŒ€í•´ ë¯¸ë¦¬ ê³µë¶€í•˜ê³ , ë‚´ ë‚˜ë¦„ëŒ€ë¡œ ì´í•´í•´ë³´ë ¤ê³  ì‘ì„±í•˜ëŠ” ê¸€. êµ¬ê¸€ë§í•˜ê³ , ë‚´ê°€ ì´í•´í•˜ê¸° ì‰½ê²Œ ì‘ì„±í•¨.

# ğŸ”Â WebRTC?

ğŸ”’Web Real-Time Communication 

ìµœëŒ€í•œ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³ ,, Peerê°„ì— ì‹¤ì‹œê°„ ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì†¡ìˆ˜ì‹ ì„ ê°€ëŠ¥í•˜ë„ë¡ í•˜ëŠ” P2P

ğŸ”“ë¹„ë””ì˜¤, ìŒì„±, ì¼ë°˜ ë°ì´í„°ë¥¼ ì‚¬ìš©ìê°„ì— ì„œë¡œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ì†¡ë˜ë„ë¡ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ë§í•œë‹¤!

ê·¼ë° â€˜ì„œë²„â€™ëŠ” ê±°ì¹˜ì§€ ì•ŠëŠ”ë°, ICE í”„ë ˆì„ì›Œí¬ê°€ ë‹¤ë¥¸ ì„œë²„ë¥¼ ê±°ì¹œë‹¤..(?)

## ğŸ“•Â WebRTC APIì— ëŒ€í•œ í”„ë¡œí† ì½œ

### 1. ICE(Interactive Connectivity Establishment)

ğŸ“ƒÂ ë§Œì•½ì— peerë¼ë¦¬ ë‹¨ìˆœíˆ ë°”ë¡œ ì—°ê²°ì„ í•˜ë ¤ê³  í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•  ìˆ˜ ì—†ë‹¤. ì™œëƒë©´ ë°©í™”ë²½ë„ í†µê³¼í•´ì•¼í•˜ê³ , Public IPê°€ ì—†ìœ¼ë©´ ìœ ì¼í•œ ì£¼ì†Œê°’ì„ ìƒˆë¡œ í• ë‹¹í•´ì•¼ í•˜ë©°, ë¼ìš°í„°ê°€ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ë¥¼ ë¦´ë ˆì´ í•´ì•¼ í•œë‹¤. 

ğŸ‘‰Â ê·¸ë˜ì„œ ICEë¼ëŠ” **í”„ë ˆì„ì›Œí¬**ê°€ ìˆë‹¤. 

ICEì—ì„œëŠ” peerê°„ ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•  ë°©ë²•ìœ¼ë¡œ **STUNì„œë²„, TURN ì„œë²„**ë¥¼ ì‚¬ìš©í•œë‹¤. 

(ë‘˜ë‹¤ ì‚¬ìš©í•´ë„ ë˜ê³ , í•˜ë‚˜ë¥¼ ì‚¬ìš©)

## ğŸ“•Â WebRTC: ì„œë²„ì˜ ì¢…ë¥˜

### 1. Signaling Server

ğŸ“ƒÂ 1. ì»´í“¨í„° ë‘ê°œê°€ ì„œë¡œ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ”ë°, ì—°ê²°ì„ ì‹œí‚¤ê³  ì‹¶ë‹¤. 

1. ê·¼ë° ì—°ê²°ì„ í•˜ë ¤ë©´, Session Control Messages, Error Messages, Codec, Bandwidth ë“±.. ì´ë ‡ê²Œ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ì„œë¡œì˜ ì»´í“¨í„°ì—ê²Œ ì „ë‹¬ì´ ë˜ì•¼ ê°€ëŠ¥í•¨. 
2. ì„œë¡œ ì»´í“¨í„°ì—ê²Œ ì „ë‹¬í•´ì£¼ëŠ” **â€˜í”„ë¡œì„¸ìŠ¤â€™**ë¥¼ **â€˜Signalingâ€™**ì´ë¼ê³  í•¨
    
    ( Signalingì´ ì–´ë–¤ ê°’ì´ë‚˜ ê·¸ëŸ°ê²Œ ì•„ë‹ˆë¼, **ì£¼ê³  ë°›ëŠ” ê³¼ì •**ì„ ì§€ì¹­í•˜ëŠ” ë§! ) 
    
3. ê·¸ë¦¬ê³  ì»´í“¨í„° ì‚¬ì´ì—ì„œ, ìœ„ì˜ ì •ë³´ë“¤ì„ ì¤‘ê³„í•´ì£¼ëŠ” ì¤‘ê°œì ì—­í• ì„ í•´ì£¼ëŠ” ì„œë²„ë¥¼ **â€˜Signaling Serverâ€™**ë¼ê³  í•œë‹¤. ê·¸ë¦¬ê³  ì •ë³´ë“¤ì„ ì£¼ê³  ë°›ì„ ë•ŒëŠ”, SDP(Session Description Protocol) ì„ ì‚¬ìš©í•œë‹¤. 
4. ê·¸ë˜ì„œ Signaling Serverë¥¼ ì§ì ‘ êµ¬ì¶•í•´ì•¼í•˜ëŠ”ë°, ë³´í†µ **WebSoket**ì„ ì‚¬ìš©í•´ì„œ í´ë¼ì´ì–¸íŠ¸ìª½ ê³¼ í†µì‹ í•œë‹¤. 

### 2. STUN server( Session Traversal Utilities for NAT)

ğŸ“Â í´ë¼ì´ì–¸íŠ¸ì˜ **ê³µì¸ IP(Public Address)**ë¥¼ ì•Œë ¤ì£¼ëŠ” ì„œë²„

- Peerê°„ì˜ ë‹¨ìˆœ ì—°ê²°ë°©ë²•ìœ¼ë¡  ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì‚¬ìš©
- ë°©í™”ë²½, NATí™˜ê²½ì—ì„œ í•„ìš”í•œ Serverì„ .

ğŸ“ƒ1. ClientAëŠ” STUN serverì— â€˜ë‚´ ê³µì¸ipì£¼ì†Œì¢€ ì•Œë ¤ì¤„ë˜?â€™í•˜ê³  ìš”ì²­ì„ í•˜ê³ , STUN Serverê°€ 

ì•Œë ¤ì¤€ë‹¤

1. ClientA ëŠ” ëŒë ¤ë°›ì€ IPì£¼ì†Œë¥¼ í™œìš©í•´ì„œ, ClientBì™€ Signalingì´ ê°€ëŠ¥í•´ì§„ë‹¤. 
2. STUN ServerëŠ” ì˜¤í”ˆì†ŒìŠ¤ë¥¼ í™œìš©í•´ë„ ëœë‹¤. 

### 2-1. NAT(Network Address Translation)

ğŸ“Â **ë‹¨ë§ì— ê³µê°œIPì£¼ì†Œë¥¼ í• ë‹¹**í•˜ê¸° ìœ„í•´ ì‚¬ìš©

ğŸ“ƒÂ ë¼ìš°í„°ëŠ” ê³µê°œ IPì£¼ì†Œë¥¼ ê°€ì§€ê³  ìˆìŒ. 

ê·¸ë¦¬ê³  ëª¨ë“  ë‹¨ë§ë“¤ì€ ë¼ìš°í„°ì— ì—°ê²°ë˜ì–´ ìˆê³  + ë¹„ê³µê°œ IPì£¼ì†Œë¥¼ ê°€ì§€ê³  ìˆìŒ

â€˜ìš”ì²­â€™ì€ ë‹¨ë§ì˜ ë¹„ê³µê°œì£¼ì†Œ, ë¼ìš°í„°ì˜ ê³µê°œì£¼ì†Œ, ìœ ì¼í•œ í¬íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë²ˆì—­ë¨. ê·¸ë˜ì„œ ê°ê° ë‹¨ë§ì´ ìœ ì¼í•œ ê³µê°œIPê°€ ì—†ëŠ”ë°ë„ ì¸í„°ë„· ìƒì—ì„œ ê²€ìƒ‰ì´ ê°€ëŠ¥í•´ì§. 

â—ê·¼ë° ëª‡ëª‡ ë¼ìš°í„°ë“¤ì€ì œí•œì„ ìœ„í•œ NATë¥¼ ì±„ìš©í•¨. Symmetric NATì´ë¼ê³  í•˜ëŠ”ë°, ì´ê±´ Peerë“¤ì´ ì˜¤ì§! ì´ì „ì— ì—°ê²°í–ˆë˜ ì ì´ ìˆëŠ” â€˜ì—°ê²°â€™ë§Œ í—ˆìš©í•´ì¤Œ. ê·¸ë˜ì„œ STUN ì„œë²„ê°€ ê³µê°œIPì£¼ì†Œë¥¼ ì•Œë ¤ì¤€ë‹¤í•´ë„, ëª¨ë‘ ì—°ê²°ì´ ëœë‹¤!ê³  í•  ìˆ˜ ìˆëŠ” ê²Œ ì•„ë‹˜. 

***â‡’ TURNì´ í•„ìš”***

### 3. TURN(Traversal Using Relays around NAT) Server

ğŸ“Â **Symmetric NAT ì œí•œ**ì— ëŒ€í•´ ìš°íšŒí•  ìˆ˜ ìˆê²Œ í•´ì¤Œ

ğŸ“ƒÂ TURN ì„œë²„ì™€ ì—°ê²°í•˜ê³ , ëª¨ë“  ì •ë³´ë¥¼ ì„œë²„ì— ì „ë‹¬.

> Peerê°„ì˜ í†µì‹ ì— ëŒ€í•´ ì¤‘ê³„ì ì—­í• 
> 
> - ìƒë‹¹í•œ ë¶€í•˜ ë°œìƒ( ì˜¤ë²„í—¤ë“œ)
> - ë¹„ìš©ì¦ê°€
> - Local IP, Public IP ë‘˜ë‹¤ ì—°ê²°ì´ í˜ë“¤ ë•Œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ, ëŒ€ì•ˆì´ ì—†ì„ ë•Œ ì‚¬ìš©.

### 4. SDP(Session Description Protocol)

ğŸ“ë©€í‹°ë¯¸ë””ì–´ ì»¨í…ì¸ ì˜ ì—°ê²°ì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ í‘œì¤€(í•´ìƒë„, í˜•ì‹, ì½”ë±, ì•”í˜¸í™” ë“± ) 

ğŸ“ƒÂ ë‘ê°œì˜ Peerì—ì„œ, ë‹¤ë¥¸ í•œ ìª½ì´ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ê³  ìˆëŠ” ê±¸ ì•Œê²Œ í•´ì¤€ë‹¤.. 

ì»¨í…ì¸  ìì²´ê°€ x, ì»¨í…ì¸ ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ì˜ ì„¤ëª…ì„. 

---

## ğŸ“•Â WebRTC êµ¬í˜„ë°©ì‹

- P2Pì—°ê²°ë¡œ 1ëŒ€1ì´ ì•„ë‹ˆë¼, N:M ì²˜ëŸ¼ ë” ì¦ê°€ëœ ì¸ì›ì— ëŒ€í•´ì„œ ë°ì´í„° ì†¡ìˆ˜ì‹ ì„ ì§€ì›í•˜ë ¤ê³  í•œë‹¤ë©´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ê³¼ë¶€í•˜ê°€ ì‹¬í•˜ê²Œ ì˜¬ ìˆ˜ ìˆë‹¤. Nëª…ì´ ì°¸ì—¬í•œë‹¤ë©´, ê° í´ë¼ì´ì–¸íŠ¸ëŠ” N-1ëª…ì— ëŒ€í•´ì„œ ì—°ê²°ì„±ì„ ìœ ì§€í•´ì•¼í• í…Œë‹ˆê¹Œ ê³¼ë¶€í•˜ê°€ ì˜¬ ìˆ˜ ë°–ì— ì—†ë‹¤.

ğŸ‘‰Â ê·¸ë˜ì„œ MediaServerë¥¼ ë‘ëŠ”ë°, Media Serverë¥¼ ë‘ëŠ” ë°©ì‹ì— SFU, MCUë°©ì‹ì´ ìˆìŒ

### 1. Mesh

ğŸ“ŒÂ **Signaling Server, STUN Server, TURN Serverë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹**

**1:1,  ì†Œê·œëª¨ ì—°ê²°ì— ì í•©**

---

> ì¥ì 
> 
- ìœ„ 3ê°œì˜ serverëª¨ë‘ ê²°êµ­ Peerê°„ì˜ Signalingê³¼ì •ë§Œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ì˜ ë¶€í•˜ê°€ ì ìŒ.
- Peerë¼ë¦¬ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ë˜ë‹ˆê¹Œ ì‹¤ì‹œê°„ ì„±ì´ ë³´ì¥ë¨.

> ë‹¨ì 
> 
- Clientê°€ ë§ì•„ì§€ë©´, Clientì¸¡ì˜ ë¶€í•˜ê°€ ê¸‰ê²©íˆ ì¦ê°€í•˜ê²Œ ë¨
- ì´ 5ëª…ì´ë©´, í•œ Clientë‹¹ 4ëª…ì˜ Clientì— ëŒ€í•´ì„œ ì—°ê²°ì„±ì„ ìœ ì§€í•´ì•¼í•˜ê¸° ë•Œë¬¸ì„.
    - Uplink(ë‚˜ì™€ ì—°ê²°ëœ ì‚¬ìš©ìì—ê²Œ ë³´ë‚´ëŠ” ë°ì´í„° ê°¯ìˆ˜ )
    - Downlink(ë‚˜ì™€ ì—°ê²°ëœ ë‹¤ë¥¸ ì‚¬ìš©ìê°€, ë‚˜ì—ê²Œ ë³´ë‚´ëŠ” ë°ì´í„° ê°¯ìˆ˜)
    - 5ëª… â†’ ì´ 8ê°œì˜ linkë¥¼ ìœ ì§€í•´ì•¼ í•¨.

### 2. SFU(Selective Forwarding Unit)

**ğŸ“ŒMedia Serverë¥¼ ë‘ê³ , Media Serverê°€ Peerê°„ì˜ ë¯¸ë””ì–´ íŠ¸ë˜í”½ì„ ì¤‘ê³„í•˜ëŠ” ë°©ì‹**

ğŸ“ƒÂ P2Pë°©ì‹ì´ ì•„ë‹˜! Serverì™€ Clientì‚¬ì´ì—ì„œ peerë¥¼ ì—°ê²°í•œë‹¤. 

ëª¨ë“  ì‚¬ìš©ìí•œí…Œ ë°ì´í„°ë¥¼ ë³´ë‚¼ í•„ìš”ê°€ ì—†ê³ , Media Serverì—ê²Œë§Œ ìì‹ ì˜ ì˜ìƒ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´ ë¨. 

ê·¼ë° ë‹¤ë¥¸ ì‚¬ëŒë“¤ êº¼ëŠ” ë°›ì•„ì•¼ í•˜ë‹ˆê¹Œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ìˆ˜ë§Œí¼ ë°›ëŠ” peerëŠ” ìœ ì§€í•´ì•¼ í•œë‹¤. 

**1:N, ì†Œê·œëª¨ N:Mí˜•ì‹**ì˜ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°ë°©ì‹ì— ì í•©

---

> ì¥ì 
> 
- Meshë°©ì‹ë³´ë‹¨ ëŠë ¤ë„, ê´œì°®ì€ ì‹¤ì‹œê°„ì„±ì„ ìœ ì§€í•œë‹¤.
- ëŒ€ì‹  Meshë°©ì‹ë³´ë‹¨, Clientì˜ ë¶€í•˜ë¥¼ ì¤„ì—¬ì¤€ë‹¤.

> ë‹¨ì 
> 
- Meshë°©ì‹ë³´ë‹¤ Clientì˜ ë¶€í•˜ëŠ” ì¤„ì§€ë§Œ, ëŒ€ì‹  ì„œë²„ì˜ ë¶€í•˜ëŠ” ëŠ˜ì–´ë‚œë‹¤.

### 3. MCU(Multi-Point Control Unit)

**ğŸ“ŒÂ Media Serverê°€! ì†¡ì¶œë˜ëŠ” ë¯¸ë””ì–´ ë°ì´í„° ì—¬ëŸ¬ ê°œë¥¼ í˜¼í•©(muxing)/ê°€ê³µ(transcoding)í•´ì„œ**

 **â‡’  ìˆ˜ì‹ Peerì— ì „ë‹¬í•˜ëŠ” ë°©ì‹**

---

> ì¥ì 
> 
- Clientì¸¡ì˜ ë¶€í•˜ê°€ ì¤„ì–´ë“¤ê²Œ ëœë‹¤
- ê·¸ë˜ì„œ **N:M** êµ¬ì¡°ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•´ì§„ë‹¤.

> ë‹¨ì 
> 
- Peerê°„ì˜ ì§ì ‘ì ì¸ ì—°ê²°ì´ ì•„ë‹ˆë‹ˆê¹Œ ì‹¤ì‹œê°„ì„±ì´ ë–¨ì–´ì§€ê²Œ ë¨
- ê¸°ìˆ ì  êµ¬í˜„ì˜ ì–´ë ¤ì›€ì´ ë™ë°˜ëœë‹¤

ì°¸ê³ 

[WebRTC](https://webrtc.org/)

[Introduction to WebRTC protocols - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Protocols)

[[ê°œë°œ] WebRTC & SpringBoot & Vue.jsë¥¼ í™œìš©í•œ Group Video Call 1 : ì´ë¡ ](https://velog.io/@jsb100800/%EA%B0%9C%EB%B0%9C-WebRTC-SpringBoot-Vue.js%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-Group-Video-Call)

[1. WebRTC ì •ë¦¬í•˜ê¸°](https://surprisecomputer.tistory.com/7?category=909008)